0) ä¸€å¥è¯å®šä½ï¼ˆPositioningï¼‰
åšä¸€ä¸ª gh ç”Ÿæ€/ç‹¬ç«‹ CLIï¼šæŠŠ GitHub Actions çš„â€œç”¨é‡/æ—¶é•¿â€ç¿»è¯‘æˆâ€œæˆæœ¬ + æµªè´¹çƒ­åŒº + å¯æ‰§è¡Œå‘Šè­¦â€ï¼Œ
5 åˆ†é’Ÿç”Ÿæˆä¸€ä»½ä½ èƒ½çœ‹æ‡‚ã€èƒ½çœé’±çš„æŠ¥å‘Šï¼ˆReportï¼‰ã€‚

å…³é”®è¯ï¼ˆKey termsï¼‰ï¼š

CIï¼ˆContinuous Integrationï¼‰ï¼šæŒç»­é›†æˆ
Hotspotï¼šçƒ­åŒºï¼ˆæœ€çƒ§é’±/æœ€æµªè´¹çš„å·¥ä½œæµæˆ– Jobï¼‰
Wasteï¼šæµªè´¹ï¼ˆå¤±è´¥é‡è·‘ã€é‡å¤å·¥ä½œã€é•¿å°¾æ’é˜Ÿç­‰ï¼‰
Budget alertï¼šé¢„ç®—å‘Šè­¦
================================================================================

ç›®æ ‡ç”¨æˆ·ï¼ˆICPï¼‰ä¸ç¬¬ä¸€æ³¢åœºæ™¯ï¼ˆUse casesï¼‰
================================================================================
ICPï¼ˆIdeal Customer Profileï¼‰ï¼š
â”œâ”€ ä½¿ç”¨ GitHub Actions çš„å°å›¢é˜Ÿ / indie SaaS / OSS ç»´æŠ¤è€…
â”œâ”€ è´¦å•ä¸Šæ¶¨ä½†å®šä½ä¸äº†â€œåˆ°åº•è°åœ¨çƒ§é’±â€
â””â”€ å¯¹ macOS / Windows runner æ›´æ•æ„Ÿï¼ˆæˆæœ¬ä¹˜æ•°æ˜æ˜¾ï¼‰
é¦–æ³¢æœ€å¼ºåœºæ™¯ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰ï¼š
â”œâ”€ åœºæ™¯ Aï¼šæ¯æœˆ Actions minutes é£™å‡ï¼Œæƒ³å®šä½ top workflows/jobs
â”œâ”€ åœºæ™¯ Bï¼šPR CI å¾ˆæ…¢/ç»å¸¸å¤±è´¥é‡è·‘ï¼Œæƒ³é‡åŒ–æµªè´¹
â””â”€ åœºæ™¯ Cï¼šæƒ³è®¾ç½®â€œæ¯å‘¨é¢„ç®—é˜ˆå€¼â€ï¼Œè¶…äº†å°±æé†’

# CICost å®Œæ•´æŠ€æœ¯æ–‡æ¡£ v1.0

```
é¡¹ç›®åç§°ï¼šCICost
å®šä½ï¼šGitHub Actions æˆæœ¬ä¸æµªè´¹çƒ­åŒºåˆ†æ CLI
æ—¥æœŸï¼š2026-02-26
ç‰ˆæœ¬ï¼šv1.0-MVP
```

---

## ç›®å½•

```
1. æ”¹è¿›æ€»ç»“ï¼ˆç›¸æ¯”åŸæ–¹æ¡ˆï¼‰
2. äº§å“å®šä½ä¸å‘½ä»¤è®¾è®¡
3. ç³»ç»Ÿæ¶æ„
4. æ•°æ®æ¨¡å‹
5. æ ¸å¿ƒç®—æ³•
6. å‘½ä»¤è§„æ ¼ï¼ˆé€æ¡ï¼‰
7. é…ç½®ä½“ç³»
8. å·¥ç¨‹è§„èŒƒ
9. éªŒæ”¶æ ‡å‡†ï¼ˆç»†åŒ–ï¼‰
10. é‡Œç¨‹ç¢‘ä¸æ’æœŸ
11. é£é™©æ¸…å•ä¸é™çº§
12. é™„å½•
```

---

## 1. æ”¹è¿›æ€»ç»“ï¼ˆç›¸æ¯”åŸæ–¹æ¡ˆçš„ 12 å¤„ä¼˜åŒ–ï¼‰

```
åŸæ–¹æ¡ˆé—®é¢˜                              æ”¹è¿›æ–¹æ¡ˆ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. æ¯æ¬¡ scan å…¨é‡æ‹‰å–ï¼Œå¤§ä»“åº“å¾ˆæ…¢         â†’ å¢é‡åŒæ­¥ï¼ˆIncremental Syncï¼‰
2. ç¼“å­˜ç­–ç•¥ä¸æ˜ç¡®                         â†’ SQLite + æ˜ç¡®è¿‡æœŸ/å¤±æ•ˆç­–ç•¥
3. æœªè€ƒè™‘ GitHub å…è´¹é¢åº¦                 â†’ å¼•å…¥ Free Tier æ‰£å‡é€»è¾‘
4. æœªè€ƒè™‘ self-hosted runner              â†’ runner åˆ†ç±»ï¼šhosted / self-hosted
5. æœªè€ƒè™‘ larger runner å®šä»·              â†’ pricing.yml æ”¯æŒ runner label æ˜ å°„
6. å¹¶å‘æ‹‰å–æœªæåŠï¼Œå¤§ä»“åº“ä½“éªŒå·®            â†’ å¹¶å‘ worker pool + è¿›åº¦æ¡
7. æ— è¶‹åŠ¿å¯¹æ¯”åŠŸèƒ½                         â†’ æ”¯æŒ --compareï¼ˆæœ¬å‘¨ vs ä¸Šå‘¨ï¼‰
8. budget åªæ”¯æŒ stdout                   â†’ æ”¯æŒ webhook / æ–‡ä»¶è¾“å‡º
9. æ— é¡¹ç›®çº§é…ç½®ï¼ˆå›¢é˜Ÿå…±äº«ï¼‰                â†’ .cicost.yml ä»“åº“çº§é…ç½®
10. æ—  schema ç‰ˆæœ¬ç®¡ç†                    â†’ JSON è¾“å‡ºå¸¦ schema_version
11. é”™è¯¯å¤„ç†ç²’åº¦ç²—                        â†’ åˆ†çº§é”™è¯¯ç  + partial result
12. æ— å®‰è£…åå¼•å¯¼ï¼ˆonboardingï¼‰             â†’ cicost init äº¤äº’å¼åˆå§‹åŒ–
```

---

## 2. äº§å“å®šä½ä¸å‘½ä»¤è®¾è®¡

### 2.1 ä¸€å¥è¯å®šä½

```
CICostï¼š5 åˆ†é’ŸæŠŠ GitHub Actions ç”¨é‡ç¿»è¯‘æˆæˆæœ¬æŠ¥å‘Š + æµªè´¹çƒ­åŒº + é¢„ç®—å‘Šè­¦ã€‚
```

### 2.2 å®‰è£…æ–¹å¼

```bash
# æ–¹å¼ Aï¼šGitHub CLI æ‰©å±•ï¼ˆæ¨èï¼‰
gh extension install user/gh-cicost
gh cicost scan --repo owner/repo

# æ–¹å¼ Bï¼šç‹¬ç«‹äºŒè¿›åˆ¶
brew install cicost          # macOS
curl -sL install.sh | sh     # Linux
scoop install cicost         # Windows

# æ–¹å¼ Cï¼šGo install
go install github.com/user/cicost@latest
```

### 2.3 å®Œæ•´å‘½ä»¤æ ‘

```
cicost
â”œâ”€â”€ init                          # äº¤äº’å¼åˆå§‹åŒ–é…ç½®
â”œâ”€â”€ scan                          # æ‹‰å–æ•°æ®å¹¶ç¼“å­˜
â”‚   â”œâ”€â”€ --repo owner/repo         # æŒ‡å®šä»“åº“ï¼ˆå¿…éœ€ï¼‰
â”‚   â”œâ”€â”€ --days N                  # æ—¶é—´çª—å£ï¼ˆé»˜è®¤ 30ï¼‰
â”‚   â”œâ”€â”€ --incremental             # å¢é‡æ¨¡å¼ï¼ˆé»˜è®¤å¼€å¯ï¼‰
â”‚   â”œâ”€â”€ --full                    # å¼ºåˆ¶å…¨é‡
â”‚   â””â”€â”€ --workers N               # å¹¶å‘æ•°ï¼ˆé»˜è®¤ 4ï¼‰
â”œâ”€â”€ report                        # ç»¼åˆæŠ¥å‘Š
â”‚   â”œâ”€â”€ --repo owner/repo
â”‚   â”œâ”€â”€ --days N
â”‚   â”œâ”€â”€ --format table|md|json|csv
â”‚   â”œâ”€â”€ --compare                 # ä¸ä¸Šä¸€å‘¨æœŸå¯¹æ¯”
â”‚   â””â”€â”€ --output file.md          # è¾“å‡ºåˆ°æ–‡ä»¶
â”œâ”€â”€ hotspots                      # çƒ­åŒºæ’è¡Œ
â”‚   â”œâ”€â”€ --group-by workflow|job|runner|branch
â”‚   â”œâ”€â”€ --top N                   # æ˜¾ç¤ºå‰ N æ¡ï¼ˆé»˜è®¤ 10ï¼‰
â”‚   â””â”€â”€ --sort cost|minutes|fail_rate|waste
â”œâ”€â”€ budget                        # é¢„ç®—å‘Šè­¦
â”‚   â”œâ”€â”€ --weekly N | --monthly N  # é˜ˆå€¼ï¼ˆç¾å…ƒï¼‰
â”‚   â”œâ”€â”€ --notify stdout|webhook|file
â”‚   â””â”€â”€ --webhook-url URL         # Webhook åœ°å€
â”œâ”€â”€ explain                       # å¯æ‰§è¡Œå»ºè®®
â”‚   â””â”€â”€ --repo owner/repo
â”œâ”€â”€ config                        # æŸ¥çœ‹/ç¼–è¾‘é…ç½®
â”‚   â”œâ”€â”€ show
â”‚   â””â”€â”€ edit
â””â”€â”€ version                       # ç‰ˆæœ¬ä¿¡æ¯
```

---

## 3. ç³»ç»Ÿæ¶æ„

### 3.1 æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    User Terminal                         â”‚
â”‚                    cicost <command>                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Command Router                         â”‚
â”‚   è§£æå‚æ•° â†’ æ ¡éªŒ â†’ åˆ†å‘åˆ°å¯¹åº” Handler                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â–¼              â–¼              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Config  â”‚  â”‚  Auth    â”‚  â”‚  Pricing     â”‚
    â”‚  Loader  â”‚  â”‚  Layer   â”‚  â”‚  Engine      â”‚
    â”‚          â”‚  â”‚          â”‚  â”‚              â”‚
    â”‚ åŠ è½½é…ç½®  â”‚  â”‚ gh token â”‚  â”‚ pricing.yml  â”‚
    â”‚ åˆå¹¶ä¼˜å…ˆçº§â”‚  â”‚ ç¯å¢ƒå˜é‡  â”‚  â”‚ free tier    â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚             â”‚               â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜               â”‚
                â–¼                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚       Data Fetch Layer        â”‚      â”‚
â”‚                               â”‚      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚      â”‚
â”‚  â”‚ GitHub REST API Client  â”‚  â”‚      â”‚
â”‚  â”‚ - GET workflow runs     â”‚  â”‚      â”‚
â”‚  â”‚ - GET jobs for run      â”‚  â”‚      â”‚
â”‚  â”‚ - GET workflow files    â”‚  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚      â”‚
â”‚               â”‚               â”‚      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚      â”‚
â”‚  â”‚ Concurrency Manager     â”‚  â”‚      â”‚
â”‚  â”‚ - Worker pool (N=4)     â”‚  â”‚      â”‚
â”‚  â”‚ - Rate limit tracker    â”‚  â”‚      â”‚
â”‚  â”‚ - Backoff & retry       â”‚  â”‚      â”‚
â”‚  â”‚ - Progress bar          â”‚  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚      â”‚
â”‚               â”‚               â”‚      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚      â”‚
â”‚  â”‚ Incremental Sync        â”‚  â”‚      â”‚
â”‚  â”‚ - Last sync cursor      â”‚  â”‚      â”‚
â”‚  â”‚ - Delta detection       â”‚  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
                â”‚                      â”‚
                â–¼                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚       Local Store (SQLite)    â”‚      â”‚
â”‚                               â”‚      â”‚
â”‚  Tables:                      â”‚      â”‚
â”‚  - workflow_runs              â”‚      â”‚
â”‚  - jobs                       â”‚      â”‚
â”‚  - sync_meta                  â”‚      â”‚
â”‚  - budget_history             â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
                â”‚                      â”‚
                â–¼                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Analytics Engine                  â”‚
â”‚                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Cost Calc   â”‚  â”‚ Waste Calc   â”‚        â”‚
â”‚  â”‚             â”‚  â”‚              â”‚        â”‚
â”‚  â”‚ minutes     â”‚  â”‚ fail_rate    â”‚        â”‚
â”‚  â”‚ Ã— os_mult   â”‚  â”‚ rerun_waste  â”‚        â”‚
â”‚  â”‚ Ã— price     â”‚  â”‚ cancel_waste â”‚        â”‚
â”‚  â”‚ - free_tier â”‚  â”‚ queue_time   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚         â”‚                â”‚                â”‚
â”‚         â–¼                â–¼                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Aggregator                      â”‚      â”‚
â”‚  â”‚ - group by workflow/job/runner  â”‚      â”‚
â”‚  â”‚ - rank / sort                   â”‚      â”‚
â”‚  â”‚ - trend compare                 â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Output Layer                        â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚Table â”‚ â”‚ MD â”‚ â”‚ JSON â”‚ â”‚ CSV â”‚ â”‚Alert â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â”‚  Exit Code:                                 â”‚
â”‚  0 = OK                                     â”‚
â”‚  1 = Error                                  â”‚
â”‚  2 = Budget exceeded                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 ç›®å½•ç»“æ„

```
cicost/
â”œâ”€â”€ cmd/                          # å‘½ä»¤å…¥å£
â”‚   â”œâ”€â”€ root.go                   # æ ¹å‘½ä»¤
â”‚   â”œâ”€â”€ init.go
â”‚   â”œâ”€â”€ scan.go
â”‚   â”œâ”€â”€ report.go
â”‚   â”œâ”€â”€ hotspots.go
â”‚   â”œâ”€â”€ budget.go
â”‚   â”œâ”€â”€ explain.go
â”‚   â””â”€â”€ config.go
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ auth/                     # è®¤è¯
â”‚   â”‚   â””â”€â”€ token.go              # gh token / env var
â”‚   â”œâ”€â”€ github/                   # GitHub API å°è£…
â”‚   â”‚   â”œâ”€â”€ client.go             # HTTP client + rate limit
â”‚   â”‚   â”œâ”€â”€ runs.go               # workflow runs API
â”‚   â”‚   â”œâ”€â”€ jobs.go               # jobs API
â”‚   â”‚   â””â”€â”€ pagination.go         # åˆ†é¡µå¤„ç†
â”‚   â”œâ”€â”€ store/                    # æœ¬åœ°å­˜å‚¨
â”‚   â”‚   â”œâ”€â”€ sqlite.go             # SQLite æ“ä½œ
â”‚   â”‚   â”œâ”€â”€ schema.go             # å»ºè¡¨/è¿ç§»
â”‚   â”‚   â””â”€â”€ sync.go               # å¢é‡åŒæ­¥æ¸¸æ ‡
â”‚   â”œâ”€â”€ pricing/                  # å®šä»·å¼•æ“
â”‚   â”‚   â”œâ”€â”€ engine.go             # è®¡ç®—é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ loader.go             # åŠ è½½ pricing.yml
â”‚   â”‚   â””â”€â”€ freetier.go           # å…è´¹é¢åº¦æ‰£å‡
â”‚   â”œâ”€â”€ analytics/                # åˆ†æå¼•æ“
â”‚   â”‚   â”œâ”€â”€ cost.go               # æˆæœ¬è®¡ç®—
â”‚   â”‚   â”œâ”€â”€ waste.go              # æµªè´¹æŒ‡æ ‡
â”‚   â”‚   â”œâ”€â”€ hotspots.go           # çƒ­åŒºæ’è¡Œ
â”‚   â”‚   â”œâ”€â”€ trend.go              # è¶‹åŠ¿å¯¹æ¯”
â”‚   â”‚   â””â”€â”€ budget.go             # é¢„ç®—åˆ¤æ–­
â”‚   â””â”€â”€ output/                   # è¾“å‡ºæ ¼å¼åŒ–
â”‚       â”œâ”€â”€ table.go
â”‚       â”œâ”€â”€ markdown.go
â”‚       â”œâ”€â”€ json.go
â”‚       â””â”€â”€ csv.go
â”œâ”€â”€ configs/
â”‚   â””â”€â”€ pricing_default.yml       # é»˜è®¤å®šä»·è¡¨
â”œâ”€â”€ testdata/                     # æµ‹è¯• fixtures
â”‚   â”œâ”€â”€ runs_response.json
â”‚   â”œâ”€â”€ jobs_response.json
â”‚   â””â”€â”€ expected_report.json
â”œâ”€â”€ .cicost.yml.example           # ä»“åº“çº§é…ç½®æ¨¡æ¿
â”œâ”€â”€ go.mod
â”œâ”€â”€ go.sum
â”œâ”€â”€ Makefile
â””â”€â”€ README.md
```

---

## 4. æ•°æ®æ¨¡å‹

### 4.1 SQLite Schema

```sql
-- ç‰ˆæœ¬ç®¡ç†
CREATE TABLE schema_version (
    version     INTEGER PRIMARY KEY,
    applied_at  TEXT NOT NULL DEFAULT (datetime('now'))
);

-- å·¥ä½œæµè¿è¡Œè®°å½•
CREATE TABLE workflow_runs (
    id              INTEGER PRIMARY KEY,    -- GitHub run ID
    repo            TEXT NOT NULL,           -- owner/repo
    workflow_id     INTEGER NOT NULL,
    workflow_name   TEXT NOT NULL,
    head_branch     TEXT,
    event           TEXT,                    -- push / pull_request / schedule ...
    status          TEXT,                    -- completed / in_progress / queued
    conclusion      TEXT,                    -- success / failure / cancelled / skipped
    run_attempt     INTEGER DEFAULT 1,
    run_started_at  TEXT,                    -- ISO8601 UTC
    updated_at      TEXT,
    created_at      TEXT,
    fetched_at      TEXT NOT NULL DEFAULT (datetime('now')),

    UNIQUE(id, run_attempt)
);

-- Job è®°å½•
CREATE TABLE jobs (
    id              INTEGER PRIMARY KEY,    -- GitHub job ID
    run_id          INTEGER NOT NULL,
    run_attempt     INTEGER DEFAULT 1,
    repo            TEXT NOT NULL,
    name            TEXT NOT NULL,           -- job name
    status          TEXT,
    conclusion      TEXT,
    started_at      TEXT,
    completed_at    TEXT,
    runner_os       TEXT,                    -- Linux / Windows / macOS
    runner_name     TEXT,
    runner_group    TEXT,
    is_self_hosted  INTEGER DEFAULT 0,      -- 0=hosted, 1=self-hosted
    duration_sec    INTEGER,                -- completed - startedï¼ˆç§’ï¼‰
    fetched_at      TEXT NOT NULL DEFAULT (datetime('now')),

    UNIQUE(id, run_attempt)
);

-- å¢é‡åŒæ­¥æ¸¸æ ‡
CREATE TABLE sync_cursors (
    repo            TEXT PRIMARY KEY,
    last_run_id     INTEGER,
    last_created_at TEXT,                   -- ä¸Šæ¬¡åŒæ­¥åˆ°çš„æœ€æ–° run çš„åˆ›å»ºæ—¶é—´
    last_sync_at    TEXT,
    total_runs      INTEGER DEFAULT 0,
    total_jobs      INTEGER DEFAULT 0
);

-- é¢„ç®—æ£€æŸ¥å†å²
CREATE TABLE budget_checks (
    id              INTEGER PRIMARY KEY AUTOINCREMENT,
    repo            TEXT NOT NULL,
    check_type      TEXT NOT NULL,           -- weekly / monthly
    period_start    TEXT NOT NULL,
    period_end      TEXT NOT NULL,
    threshold_usd   REAL NOT NULL,
    actual_usd      REAL NOT NULL,
    exceeded        INTEGER DEFAULT 0,       -- 0=no, 1=yes
    checked_at      TEXT NOT NULL DEFAULT (datetime('now'))
);

-- ç´¢å¼•
CREATE INDEX idx_runs_repo_created ON workflow_runs(repo, created_at);
CREATE INDEX idx_runs_repo_workflow ON workflow_runs(repo, workflow_name);
CREATE INDEX idx_jobs_run_id ON jobs(run_id, run_attempt);
CREATE INDEX idx_jobs_repo_runner ON jobs(repo, runner_os);
```

### 4.2 æ ¸å¿ƒæ•°æ®ç»“æ„ï¼ˆGo Structï¼‰

```go
// WorkflowRun å¯¹åº”ä¸€æ¬¡å·¥ä½œæµè¿è¡Œ
type WorkflowRun struct {
    ID            int64     `json:"id"`
    Repo          string    `json:"repo"`
    WorkflowID    int64     `json:"workflow_id"`
    WorkflowName  string    `json:"workflow_name"`
    HeadBranch    string    `json:"head_branch"`
    Event         string    `json:"event"`
    Status        string    `json:"status"`
    Conclusion    string    `json:"conclusion"`
    RunAttempt    int       `json:"run_attempt"`
    RunStartedAt  time.Time `json:"run_started_at"`
    UpdatedAt     time.Time `json:"updated_at"`
    CreatedAt     time.Time `json:"created_at"`
}

// Job å¯¹åº”ä¸€æ¬¡ Job è¿è¡Œ
type Job struct {
    ID           int64     `json:"id"`
    RunID        int64     `json:"run_id"`
    RunAttempt   int       `json:"run_attempt"`
    Repo         string    `json:"repo"`
    Name         string    `json:"name"`
    Status       string    `json:"status"`
    Conclusion   string    `json:"conclusion"`
    StartedAt    time.Time `json:"started_at"`
    CompletedAt  time.Time `json:"completed_at"`
    RunnerOS     string    `json:"runner_os"`
    RunnerName   string    `json:"runner_name"`
    IsSelfHosted bool      `json:"is_self_hosted"`
    DurationSec  int       `json:"duration_sec"`
}

// CostResult æˆæœ¬è®¡ç®—ç»“æœ
type CostResult struct {
    TotalMinutes     float64            `json:"total_minutes"`
    BillableMinutes  float64            `json:"billable_minutes"`
    TotalCostUSD     float64            `json:"total_cost_usd"`
    FreeTierUsed     float64            `json:"free_tier_used_min"`
    ByOS             map[string]OSCost  `json:"by_os"`
    PricingSnapshot  PricingSnapshot    `json:"pricing_snapshot"`
    DataCompleteness float64            `json:"data_completeness"` // 0.0~1.0
    Disclaimer       string             `json:"disclaimer"`
}

// OSCost æŒ‰æ“ä½œç³»ç»Ÿåˆ†åˆ—çš„æˆæœ¬
type OSCost struct {
    OS         string  `json:"os"`
    Minutes    float64 `json:"minutes"`
    Multiplier float64 `json:"multiplier"`
    CostUSD    float64 `json:"cost_usd"`
    Percentage float64 `json:"percentage"`
}

// WasteMetrics æµªè´¹æŒ‡æ ‡
type WasteMetrics struct {
    TotalRuns        int     `json:"total_runs"`
    FailedRuns       int     `json:"failed_runs"`
    FailRate         float64 `json:"fail_rate"`          // 0.0~1.0
    RerunCount       int     `json:"rerun_count"`
    RerunWasteMin    float64 `json:"rerun_waste_min"`
    RerunWasteUSD    float64 `json:"rerun_waste_usd"`
    CancelledRuns    int     `json:"cancelled_runs"`
    CancelWasteMin   float64 `json:"cancel_waste_min"`
    CancelWasteUSD   float64 `json:"cancel_waste_usd"`
    TotalWasteUSD    float64 `json:"total_waste_usd"`
    WastePercentage  float64 `json:"waste_percentage"`   // æµªè´¹å æ€»æˆæœ¬æ¯”ä¾‹
}

// HotspotEntry çƒ­åŒºæ¡ç›®
type HotspotEntry struct {
    Rank         int     `json:"rank"`
    Name         string  `json:"name"`
    GroupType    string  `json:"group_type"`  // workflow / job / runner / branch
    Minutes      float64 `json:"minutes"`
    CostUSD      float64 `json:"cost_usd"`
    CostPct      float64 `json:"cost_pct"`
    RunCount     int     `json:"run_count"`
    FailRate     float64 `json:"fail_rate"`
    AvgDuration  float64 `json:"avg_duration_sec"`
    Trend        string  `json:"trend"`       // â†‘ â†“ â†’ ï¼ˆå¯¹æ¯”ä¸Šå‘¨æœŸï¼‰
}
```

---

## 5. æ ¸å¿ƒç®—æ³•

### 5.1 æˆæœ¬è®¡ç®—

```
è¾“å…¥ï¼š
  jobs[]            â€” æ‰€æœ‰ Job è®°å½•
  pricing           â€” å®šä»·é…ç½®
  free_tier_minutes â€” å…è´¹é¢åº¦ï¼ˆå¯é…ç½®ï¼Œé»˜è®¤ 2000 min/monthï¼‰

æ­¥éª¤ï¼š
  1. è¿‡æ»¤æ‰ is_self_hosted = true çš„ Jobï¼ˆè‡ªæ‰˜ç®¡ä¸è®¡è´¹ï¼‰
  2. è¿‡æ»¤æ‰ status != completed çš„ Jobï¼ˆæœªå®Œæˆä¸è®¡è´¹ï¼‰
  3. å¯¹æ¯ä¸ª Jobï¼š
     a. raw_minutes = ceil(duration_sec / 60)   // GitHub å‘ä¸Šå–æ•´åˆ°åˆ†é’Ÿ
     b. billable_minutes = raw_minutes Ã— os_multiplier
        - Linux:   Ã—1
        - Windows: Ã—2
        - macOS:   Ã—10ï¼ˆM1 ä¹‹å‰ï¼‰/ Ã—10ï¼ˆæ ¹æ® pricing.ymlï¼‰
  4. æ±‡æ€»æ‰€æœ‰ billable_minutes
  5. æ‰£å‡ free_tierï¼š
     a. remaining_free = max(0, free_tier_minutes - already_used_this_month)
     b. charged_minutes = max(0, total_billable - remaining_free)
  6. cost_usd = charged_minutes Ã— per_minute_price

è¾“å‡ºï¼š
  CostResultï¼ˆå«å„ OS åˆ†åˆ—ã€å…è´¹é¢åº¦ä½¿ç”¨æƒ…å†µã€å®šä»·å¿«ç…§ï¼‰

æ³¨æ„ï¼š
  - GitHub æŒ‰"æ¯ä¸ª Job"ç‹¬ç«‹å‘ä¸Šå–æ•´åˆ°åˆ†é’Ÿï¼ˆä¸æ˜¯æ•´ä¸ª Runï¼‰
  - å…è´¹é¢åº¦è·¨ä»“åº“å…±äº«ï¼ˆç»„ç»‡çº§ï¼‰ï¼ŒCLI åªèƒ½ä¼°ç®—å•ä»“åº“çš„
  - å¿…é¡»åœ¨æŠ¥å‘Šä¸­æ ‡æ³¨ï¼šä¼°ç®—å£å¾„ + å…è´¹é¢åº¦å‡è®¾
```

### 5.2 æµªè´¹è®¡ç®—

```
æµªè´¹ç±»å‹ Aï¼šå¤±è´¥é‡è·‘æµªè´¹ï¼ˆRerun Wasteï¼‰
  å®šä¹‰ï¼šrun_attempt > 1 çš„ Run ä¸­ï¼Œattempt 1 åˆ° N-1 æ‰€æ¶ˆè€—çš„ minutes
  ç®—æ³•ï¼š
    1. æ‰¾åˆ°æ‰€æœ‰ run_attempt > 1 çš„ runs
    2. å¯¹æ¯ä¸ª run_idï¼Œæ‰¾åˆ° attempt < max_attempt çš„ jobs
    3. è¿™äº› jobs çš„ cost ä¹‹å’Œ = rerun_waste

æµªè´¹ç±»å‹ Bï¼šå¤±è´¥æµªè´¹ï¼ˆFailure Wasteï¼‰
  å®šä¹‰ï¼šconclusion = failure ä¸”æ²¡æœ‰ rerun çš„ Run æ‰€æ¶ˆè€—çš„ minutes
  è¯´æ˜ï¼šå¤±è´¥æœ¬èº«ä¸ä¸€å®šæ˜¯"æµªè´¹"ï¼ˆå¯èƒ½æ˜¯åˆç†çš„ CI æ‹¦æˆªï¼‰
       ä½†æˆ‘ä»¬æ ‡è®°å‡ºæ¥ä¾›ç”¨æˆ·åˆ¤æ–­
  ç®—æ³•ï¼š
    1. conclusion = failure ä¸” run_attempt = 1 ä¸” æ²¡æœ‰æ›´é«˜ attempt
    2. è¿™äº› runs çš„ jobs cost ä¹‹å’Œ = failure_costï¼ˆæ ‡æ³¨ä¸º"æ½œåœ¨æµªè´¹"ï¼‰

æµªè´¹ç±»å‹ Cï¼šå–æ¶ˆæµªè´¹ï¼ˆCancel Wasteï¼‰
  å®šä¹‰ï¼šconclusion = cancelled çš„ Run ä¸­ï¼Œå·²ç»è·‘è¿‡çš„ minutes
  ç®—æ³•ï¼š
    1. conclusion = cancelled çš„ runs
    2. å…¶ä¸‹ jobs ä¸­ status = completed çš„ duration ä¹‹å’Œ = cancel_waste

æ€»æµªè´¹ = rerun_waste + cancel_waste
å¤±è´¥ç‡ = failed_runs / total_runs
æµªè´¹å æ¯” = total_waste / total_cost
```

### 5.3 å¢é‡åŒæ­¥ç®—æ³•

```
cicost scan --repo owner/repo --days 30 --incremental

æ­¥éª¤ï¼š
  1. è¯»å– sync_cursors è¡¨ï¼Œè·å– last_created_at
  2. å¦‚æœå­˜åœ¨ cursorï¼š
     a. è°ƒç”¨ APIï¼šcreated >= last_created_atï¼ˆå¢é‡ï¼‰
     b. åŒæ—¶æ›´æ–° status/conclusion å¯èƒ½å˜åŒ–çš„è¿‘æœŸ runs
        ï¼ˆcreated >= now - 2hï¼Œå› ä¸º in_progress çš„ run å¯èƒ½å®Œæˆäº†ï¼‰
  3. å¦‚æœä¸å­˜åœ¨ cursorï¼ˆé¦–æ¬¡ scanï¼‰ï¼š
     a. è°ƒç”¨ APIï¼šcreated >= now - N daysï¼ˆå…¨é‡ï¼‰
  4. å¯¹æ¯ä¸ª run æ‹‰å– jobsï¼ˆå¹¶å‘ worker poolï¼‰
  5. UPSERT åˆ° SQLiteï¼ˆINSERT OR REPLACEï¼‰
  6. æ›´æ–° sync_cursors

è¾“å‡ºï¼š
  Synced: 142 runs, 567 jobs (83 new, 59 updated)
  Cache hit: 425 runs from local store
  Duration: 12.3s
```

### 5.4 é¢„ç®—åˆ¤æ–­ç®—æ³•

```
cicost budget --monthly 100 --repo owner/repo

æ­¥éª¤ï¼š
  1. ç¡®å®šå½“å‰å‘¨æœŸï¼š
     - weekly:  æœ¬å‘¨ä¸€ 00:00 UTC ~ å½“å‰
     - monthly: æœ¬æœˆ1æ—¥ 00:00 UTC ~ å½“å‰
  2. ä» SQLite æŸ¥è¯¢è¯¥å‘¨æœŸå†…æ‰€æœ‰ jobs
  3. è®¡ç®— actual_cost_usd
  4. çº¿æ€§å¤–æ¨é¢„æµ‹æœˆåº•æˆæœ¬ï¼š
     projected = actual Ã— (period_total_days / elapsed_days)
  5. åˆ¤æ–­ï¼š
     - actual > threshold     â†’ EXCEEDEDï¼ˆå·²è¶…ï¼‰
     - projected > threshold  â†’ WARNINGï¼ˆé¢„æµ‹å°†è¶…ï¼‰
     - else                   â†’ OK
  6. è¾“å‡º top 3 contributorsï¼ˆæœ€çƒ§é’±çš„ workflowï¼‰
  7. å†™å…¥ budget_checks è¡¨

é€€å‡ºç ï¼š
  0 = OK
  2 = EXCEEDED æˆ– WARNING
```

---

## 6. å‘½ä»¤è§„æ ¼ï¼ˆé€æ¡è¯¦ç»†ï¼‰

### 6.1 `cicost init`

```
ç”¨é€”ï¼šäº¤äº’å¼åˆå§‹åŒ–é…ç½®
åœºæ™¯ï¼šé¦–æ¬¡ä½¿ç”¨ï¼Œå¼•å¯¼ç”¨æˆ·è®¾ç½® repoã€pricingã€budget

äº¤äº’æµç¨‹ï¼š
  1. æ£€æµ‹ gh auth çŠ¶æ€
     â†’ å·²ç™»å½•ï¼šæ˜¾ç¤ºç”¨æˆ·å âœ“
     â†’ æœªç™»å½•ï¼šæç¤º `gh auth login` æˆ–è®¾ç½® GITHUB_TOKEN
  2. è¯¢é—®é»˜è®¤ä»“åº“ï¼ˆå¯å¤šä¸ªï¼‰
  3. é€‰æ‹©å®šä»·æ–¹æ¡ˆï¼ˆé»˜è®¤/è‡ªå®šä¹‰ï¼‰
  4. æ˜¯å¦è®¾ç½®é¢„ç®—å‘Šè­¦
  5. ç”Ÿæˆ ~/.cicost/config.yml

è¾“å‡ºæ–‡ä»¶ï¼š~/.cicost/config.yml
```

### 6.2 `cicost scan`

```
ç”¨é€”ï¼šä» GitHub API æ‹‰å–æ•°æ®åˆ°æœ¬åœ°
å‚æ•°ï¼š
  --repo owner/repo     å¿…éœ€ã€‚ç›®æ ‡ä»“åº“
  --days N              å¯é€‰ã€‚æ—¶é—´çª—å£ï¼Œé»˜è®¤ 30
  --incremental         å¯é€‰ã€‚å¢é‡æ¨¡å¼ï¼ˆé»˜è®¤ trueï¼‰
  --full                å¯é€‰ã€‚å¼ºåˆ¶å…¨é‡
  --workers N           å¯é€‰ã€‚å¹¶å‘æ•°ï¼Œé»˜è®¤ 4ï¼Œæœ€å¤§ 8

è¾“å‡ºç¤ºä¾‹ï¼š
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ CICost Scan: owner/repo                     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Period     : 2026-01-27 ~ 2026-02-26 (30d)  â”‚
  â”‚ Runs found : 234 (87 new, 12 updated)        â”‚
  â”‚ Jobs found : 1,023 (342 new, 48 updated)     â”‚
  â”‚ Cache hit  : 147 runs from local             â”‚
  â”‚ API calls  : 52 (rate limit: 4,812 remaining)â”‚
  â”‚ Duration   : 8.7s                            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é”™è¯¯å¤„ç†ï¼š
  - 401 â†’ "Token æ— æ•ˆæˆ–è¿‡æœŸã€‚è¿è¡Œ gh auth login æˆ–æ£€æŸ¥ GITHUB_TOKEN"
  - 403 rate limit â†’ è‡ªåŠ¨é€€é¿ï¼Œæ˜¾ç¤º "Rate limited. Retrying in Xs..."
  - 404 â†’ "ä»“åº“ä¸å­˜åœ¨æˆ–æ— æƒé™è®¿é—®"
  - ç½‘ç»œé”™è¯¯ â†’ æœ€å¤šé‡è¯• 3 æ¬¡ï¼Œé—´éš” 2/4/8 ç§’
  - éƒ¨åˆ†å¤±è´¥ â†’ å®Œæˆçš„æ•°æ®ç…§æ ·å…¥åº“ï¼ŒæŠ¥å‘Š"N ä¸ª run æ‹‰å–å¤±è´¥ï¼ˆå¯é‡è¯•ï¼‰"
```

### 6.3 `cicost report`

```
ç”¨é€”ï¼šç”Ÿæˆç»¼åˆæˆæœ¬æŠ¥å‘Š
å‚æ•°ï¼š
  --repo owner/repo
  --days Nï¼ˆé»˜è®¤ 30ï¼‰
  --format table|md|json|csvï¼ˆé»˜è®¤ tableï¼‰
  --compare            ä¸ä¸Šä¸€ä¸ªåŒç­‰å‘¨æœŸå¯¹æ¯”
  --output file        è¾“å‡ºåˆ°æ–‡ä»¶

Table è¾“å‡ºç¤ºä¾‹ï¼š

  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘                  CICost Report: owner/repo                          â•‘
  â•‘                  Period: 2026-01-27 ~ 2026-02-26 (30 days)          â•‘
  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
  â•‘ SUMMARY                                                             â•‘
  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
  â•‘ Total Runs                   â•‘         234 â•‘                        â•‘
  â•‘ Total Minutes (raw)          â•‘       4,521 â•‘                        â•‘
  â•‘ Total Minutes (billable)     â•‘       8,234 â•‘ (incl. OS multiplier)  â•‘
  â•‘ Estimated Cost               â•‘     $65.87  â•‘ (after free tier)      â•‘
  â•‘ Free Tier Used               â•‘   2,000 min â•‘ of 2,000 min           â•‘
  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
  â•‘ WASTE                        â•‘             â•‘                        â•‘
  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
  â•‘ Fail Rate                    â•‘      18.3%  â•‘ (43 / 234 runs)       â•‘
  â•‘ Rerun Waste                  â•‘     $12.40  â•‘ 18.8% of total cost   â•‘
  â•‘ Cancel Waste                 â•‘      $3.20  â•‘  4.9% of total cost   â•‘
  â•‘ Total Waste                  â•‘     $15.60  â•‘ 23.7% of total cost   â•‘
  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
  â•‘ BY OS                        â•‘   Minutes   â•‘   Cost                â•‘
  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
  â•‘ Linux                        â•‘     3,200   â•‘   $25.60              â•‘
  â•‘ macOS                        â•‘       312   â•‘   $24.96              â•‘
  â•‘ Windows                      â•‘       508   â•‘   $15.31 (est)        â•‘
  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
  â•‘ Pricing: v2026.02 | linux=$0.008/min | win=Ã—2 | mac=Ã—10            â•‘
  â•‘ Disclaimer: Estimates only. Free tier shared across org.            â•‘
  â•‘ Data completeness: 97.4% (6 runs skipped due to API error)         â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Markdown è¾“å‡ºï¼š
  ç”Ÿæˆæ ‡å‡† Markdown è¡¨æ ¼ï¼Œå¯ç›´æ¥ç²˜è´´åˆ° Issue/PR/Slack

JSON è¾“å‡º Schemaï¼š
  {
    "schema_version": "1.0",
    "generated_at": "2026-02-26T10:00:00Z",
    "tool_version": "0.1.0",
    "repo": "owner/repo",
    "period": { "start": "...", "end": "...", "days": 30 },
    "summary": { ... },
    "cost": { ... },
    "waste": { ... },
    "by_os": [ ... ],
    "pricing_snapshot": { ... },
    "data_completeness": 0.974,
    "disclaimer": "..."
  }
```

### 6.4 `cicost hotspots`

```
ç”¨é€”ï¼šçƒ­åŒºæ’è¡Œï¼ˆæœ€çƒ§é’±çš„ workflow/job/runner/branchï¼‰
å‚æ•°ï¼š
  --repo owner/repo
  --days N
  --group-by workflow|job|runner|branchï¼ˆé»˜è®¤ workflowï¼‰
  --top Nï¼ˆé»˜è®¤ 10ï¼‰
  --sort cost|minutes|fail_rate|wasteï¼ˆé»˜è®¤ costï¼‰
  --format table|md|json

è¾“å‡ºç¤ºä¾‹ï¼ˆ--group-by workflow --top 5ï¼‰ï¼š

  Top 5 Workflows by Cost (owner/repo, last 30 days)
  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Rank â”‚ Workflow              â”‚ Minutes â”‚ Cost($)  â”‚ Cost %    â”‚ Fail Rate â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  1   â”‚ build-and-test        â”‚  2,340  â”‚  $28.50  â”‚  43.3%    â”‚  22.1%    â”‚
  â”‚  2   â”‚ deploy-staging        â”‚    890  â”‚  $14.20  â”‚  21.6%    â”‚   8.3%    â”‚
  â”‚  3   â”‚ e2e-tests (macOS)     â”‚    180  â”‚  $14.40  â”‚  21.9%    â”‚  31.2%    â”‚
  â”‚  4   â”‚ lint-and-format       â”‚    420  â”‚   $3.36  â”‚   5.1%    â”‚   2.1%    â”‚
  â”‚  5   â”‚ release               â”‚    210  â”‚   $1.68  â”‚   2.6%    â”‚   0.0%    â”‚
  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  âš  Workflow "e2e-tests (macOS)" has 31.2% fail rate â€” investigate flaky tests

è¾“å‡ºç¤ºä¾‹ï¼ˆ--group-by runnerï¼‰ï¼š

  Top Runners by Cost
  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Rank â”‚ Runner OS â”‚ Minutes â”‚ Cost($)  â”‚ % of Total â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  1   â”‚ macOS     â”‚    312  â”‚  $24.96  â”‚  37.9%     â”‚
  â”‚  2   â”‚ Linux     â”‚  3,200  â”‚  $25.60  â”‚  38.9%     â”‚
  â”‚  3   â”‚ Windows   â”‚    508  â”‚  $15.31  â”‚  23.2%     â”‚
  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  ğŸ’¡ macOS uses only 6.9% of minutes but 37.9% of cost
```

### 6.5 `cicost budget`

```
ç”¨é€”ï¼šé¢„ç®—å‘Šè­¦
å‚æ•°ï¼š
  --repo owner/repo
  --weekly N | --monthly N     é˜ˆå€¼ï¼ˆç¾å…ƒï¼‰
  --notify stdout|webhook|file
  --webhook-url URL
  --output file

è¾“å‡ºç¤ºä¾‹ï¼ˆè¶…é¢„ç®—ï¼‰ï¼š

  ğŸ”´ BUDGET EXCEEDED
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Period   : 2026-02-01 ~ 2026-02-26         â”‚
  â”‚ Budget   : $50.00 / month                  â”‚
  â”‚ Actual   : $65.87 (131.7% of budget)       â”‚
  â”‚ Projected: $71.20 by month end             â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Top Contributors:                          â”‚
  â”‚  1. build-and-test     $28.50 (43.3%)      â”‚
  â”‚  2. e2e-tests (macOS)  $14.40 (21.9%)      â”‚
  â”‚  3. deploy-staging     $14.20 (21.6%)      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ ğŸ’¡ Tip: e2e-tests on macOS costs 10x.      â”‚
  â”‚    Consider running on Linux where possible â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é€€å‡ºç ï¼š
  0 â†’ æœªè¶…é¢„ç®—
  2 â†’ å·²è¶…æˆ–é¢„æµ‹å°†è¶…

Webhook è¾“å‡ºï¼ˆPOST JSONï¼‰ï¼š
  {
    "status": "exceeded",
    "repo": "owner/repo",
    "budget_usd": 50.00,
    "actual_usd": 65.87,
    "projected_usd": 71.20,
    "top_contributors": [...]
  }
```

### 6.6 `cicost explain`

```
ç”¨é€”ï¼šæ ¹æ®æ•°æ®ç»™å‡ºå¯æ‰§è¡Œå»ºè®®
å‚æ•°ï¼š
  --repo owner/repo
  --days N

è¾“å‡ºç¤ºä¾‹ï¼š

  CICost Recommendations for owner/repo
  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

  ğŸ”´ HIGH IMPACT
  1. Move "e2e-tests" from macOS to Linux
     Current: 312 min Ã— $0.08/min = $24.96/month
     After:   312 min Ã— $0.008/min = $2.50/month
     Saving:  ~$22.46/month (34% of total cost)

  ğŸŸ¡ MEDIUM IMPACT
  2. Investigate flaky tests in "build-and-test"
     Fail rate: 22.1% â†’ 43 failures Ã— avg 12 min = 516 wasted min
     If reduced to 5%: save ~$3.80/month

  3. Add concurrency cancellation for PR workflows
     Found: 18 cancelled runs with partial work done
     Wasted: $3.20/month
     Fix: Add `concurrency: group/cancel-in-progress: true`

  ğŸŸ¢ LOW IMPACT
  4. Cache dependencies in "lint-and-format"
     Avg duration: 8.2 min (estimated 3 min with cache)
     Saving: ~$1.40/month

è§„åˆ™å¼•æ“ï¼ˆå†…ç½®è§„åˆ™åˆ—è¡¨ï¼‰ï¼š
  RULE_001: macOS job å æ¯” > 20% æˆæœ¬ â†’ å»ºè®®è¿ç§»åˆ° Linux
  RULE_002: å¤±è´¥ç‡ > 15% â†’ å»ºè®®æ’æŸ¥ flaky tests
  RULE_003: å­˜åœ¨ cancelled runs with partial work â†’ å»ºè®®åŠ  concurrency group
  RULE_004: job å¹³å‡æ—¶é•¿ > 10 min ä¸”æ—  cache â†’ å»ºè®®åŠ ç¼“å­˜
  RULE_005: åŒä¸€ PR çŸ­æ—¶é—´å†…å¤šæ¬¡è§¦å‘ â†’ å»ºè®®åŠ  paths filter / debounce
```

---

## 7. é…ç½®ä½“ç³»

### 7.1 é…ç½®æ–‡ä»¶å±‚çº§ï¼ˆä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼‰

```
1. å‘½ä»¤è¡Œå‚æ•°           cicost report --days 7
2. ç¯å¢ƒå˜é‡             CICOST_DAYS=7
3. ä»“åº“çº§é…ç½®           .cicost.ymlï¼ˆåœ¨é¡¹ç›®æ ¹ç›®å½•ï¼‰
4. ç”¨æˆ·çº§é…ç½®           ~/.cicost/config.yml
5. å†…ç½®é»˜è®¤å€¼           ä»£ç ä¸­çš„ default
```

### 7.2 ç”¨æˆ·çº§é…ç½® `~/.cicost/config.yml`

```yaml
# ~/.cicost/config.yml

# é»˜è®¤ä»“åº“åˆ—è¡¨
repos:
  - owner/repo-a
  - owner/repo-b

# è®¤è¯ï¼ˆé€šå¸¸ä¸éœ€è¦ï¼Œè‡ªåŠ¨è¯»å– gh authï¼‰
# auth:
#   token: ${GITHUB_TOKEN}

# æ•°æ®
scan:
  days: 30
  workers: 4
  incremental: true

# å®šä»·
pricing:
  source: default                # default | custom | file:path
  # è‡ªå®šä¹‰æ—¶å¡«ä»¥ä¸‹å­—æ®µï¼š
  # linux_per_min: 0.008
  # windows_multiplier: 2
  # macos_multiplier: 10
  # currency: USD

# å…è´¹é¢åº¦
free_tier:
  plan: free                     # free(2000) | pro(3000) | team(3000) | enterprise(50000)
  minutes_per_month: 2000

# é¢„ç®—
budget:
  monthly: 100                   # ç¾å…ƒ
  weekly: 0                      # 0 = ä¸æ£€æŸ¥
  notify: stdout                 # stdout | webhook | file
  webhook_url: ""

# è¾“å‡º
output:
  format: table                  # table | md | json | csv
  color: auto                    # auto | always | never
```

### 7.3 ä»“åº“çº§é…ç½® `.cicost.yml`

```yaml
# .cicost.ymlï¼ˆæ”¾åœ¨ä»“åº“æ ¹ç›®å½•ï¼Œå›¢é˜Ÿå…±äº«ï¼‰

pricing:
  linux_per_min: 0.008
  windows_multiplier: 2
  macos_multiplier: 10

free_tier:
  plan: team

budget:
  monthly: 200
  notify: webhook
  webhook_url: https://hooks.slack.com/xxx

# å¿½ç•¥æŸäº› workflowï¼ˆä¸è®¡å…¥æŠ¥å‘Šï¼‰
ignore:
  workflows:
    - "Dependabot auto-merge"
    - "Stale issue cleanup"
```

### 7.4 é»˜è®¤å®šä»·è¡¨ `configs/pricing_default.yml`

```yaml
# GitHub Actions å®˜æ–¹å®šä»·ï¼ˆæˆªè‡³ 2026-02ï¼‰
# https://docs.github.com/en/billing/managing-billing-for-github-actions

version: "2026.02"

per_minute_usd: 0.008            # Linux åŸºå‡†

multipliers:
  Linux:     1
  Windows:   2
  macOS:     10
  macOS_xl:  10                  # M1 larger runnerï¼ˆæŒ‰å®é™…è°ƒæ•´ï¼‰

# Larger Runnersï¼ˆå¦‚æœç”¨æˆ·ä½¿ç”¨ï¼‰
larger_runners:
  linux_2core:   0.008
  linux_4core:   0.016
  linux_8core:   0.032
  linux_16core:  0.064
  linux_32core:  0.128
  linux_64core:  0.256
  windows_8core: 0.064
  macos_12core:  0.080

# å…è´¹é¢åº¦ï¼ˆæŒ‰ planï¼‰
free_tiers:
  free:       2000
  pro:        3000
  team:       3000
  enterprise: 50000
```

---

## 8. å·¥ç¨‹è§„èŒƒ

### 8.1 è®¤è¯æµç¨‹

```
cicost å¯åŠ¨æ—¶è®¤è¯æ£€æŸ¥æµç¨‹ï¼š

  1. æ£€æŸ¥å‘½ä»¤è¡Œ --token å‚æ•°
  2. æ£€æŸ¥ç¯å¢ƒå˜é‡ GITHUB_TOKEN / GH_TOKEN
  3. å°è¯•æ‰§è¡Œ `gh auth token` è·å–
  4. æ£€æŸ¥ ~/.cicost/config.yml ä¸­çš„ token
  5. ä»¥ä¸Šéƒ½æ²¡æœ‰ â†’ æŠ¥é”™å¹¶ç»™å‡ºæŒ‡å¼•ï¼š

     Error: No GitHub token found.

     To authenticate, use one of these methods:
       1. Install GitHub CLI and run: gh auth login
       2. Set environment variable: export GITHUB_TOKEN=ghp_xxx
       3. Pass directly: cicost scan --token ghp_xxx

     Required scopes: repo (for private repos), read:org (for org usage)
```

### 8.2 API è°ƒç”¨ä¸é€Ÿç‡æ§åˆ¶

```go
// Rate Limiter è®¾è®¡

type RateLimiter struct {
    Remaining   int
    Limit       int
    ResetAt     time.Time
    MinRemain   int       // ä¿ç•™é˜ˆå€¼ï¼Œä½äºæ­¤å€¼æš‚åœï¼ˆé»˜è®¤ 100ï¼‰
}

// ç­–ç•¥ï¼š
// 1. æ¯æ¬¡è¯·æ±‚åè¯»å– X-RateLimit-Remaining
// 2. Remaining < MinRemain æ—¶ï¼Œsleep åˆ° ResetAt
// 3. æ”¶åˆ° 403 rate limit æ—¶ï¼ŒæŒ‡æ•°é€€é¿ï¼š2s â†’ 4s â†’ 8s â†’ 16s â†’ æ”¾å¼ƒ
// 4. æ”¶åˆ° secondary rate limit (abuse) æ—¶ï¼Œç­‰å¾… Retry-After å¤´
// 5. å¹¶å‘ workers å…±äº« RateLimiterï¼ˆåŠ é”ï¼‰
```

### 8.3 é”™è¯¯ç ä½“ç³»

```
Exit Codes:
  0  â€” æˆåŠŸ
  1  â€” ä¸€èˆ¬é”™è¯¯ï¼ˆå‚æ•°é”™è¯¯ã€é…ç½®é”™è¯¯ã€API é”™è¯¯ï¼‰
  2  â€” é¢„ç®—è¶…é™ï¼ˆbudget exceededï¼‰

Error Types (å†…éƒ¨):
  ErrAuth           â€” è®¤è¯å¤±è´¥
  ErrNotFound       â€” ä»“åº“ä¸å­˜åœ¨æˆ–æ— æƒé™
  ErrRateLimit      â€” API é€Ÿç‡é™åˆ¶
  ErrNetwork        â€” ç½‘ç»œè¿æ¥é—®é¢˜
  ErrPartialData    â€” éƒ¨åˆ†æ•°æ®æ‹‰å–å¤±è´¥ï¼ˆéè‡´å‘½ï¼‰
  ErrInvalidConfig  â€” é…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯
  ErrNoData         â€” æœ¬åœ°æ— æ•°æ®ï¼ˆéœ€è¦å…ˆ scanï¼‰

é”™è¯¯è¾“å‡ºæ ¼å¼ï¼š
  Error: <ç®€çŸ­æè¿°>
  Detail: <å…·ä½“åŸå› >
  Hint: <ç”¨æˆ·å¯ä»¥åšä»€ä¹ˆ>
  
  ç¤ºä¾‹ï¼š
  Error: Failed to fetch workflow runs
  Detail: API returned 403 (rate limit exceeded). Reset at 10:32 UTC.
  Hint: Wait 4 minutes or reduce --workers to 2.
```

### 8.4 æ—¥å¿—ä¸è°ƒè¯•

```
--verbose / -v       æ˜¾ç¤ºè¯¦ç»†æ—¥å¿—ï¼ˆAPI è°ƒç”¨ã€ç¼“å­˜å‘½ä¸­ç­‰ï¼‰
--debug              æ˜¾ç¤ºè°ƒè¯•æ—¥å¿—ï¼ˆHTTP è¯·æ±‚/å“åº”å¤´ã€SQL æŸ¥è¯¢ï¼‰
--quiet / -q         åªè¾“å‡ºç»“æœï¼Œæ— è¿›åº¦æ¡/æç¤º
--no-color           ç¦ç”¨é¢œè‰²ï¼ˆCI ç¯å¢ƒï¼‰

æ—¥å¿—çº§åˆ«ï¼š
  INFO   â€” æ­£å¸¸æµç¨‹ï¼ˆscan è¿›åº¦ã€report ç”Ÿæˆï¼‰
  WARN   â€” éè‡´å‘½é—®é¢˜ï¼ˆéƒ¨åˆ†æ•°æ®ç¼ºå¤±ã€å®šä»·å¯èƒ½è¿‡æ—¶ï¼‰
  ERROR  â€” è‡´å‘½é”™è¯¯ï¼ˆè®¤è¯å¤±è´¥ã€ç½‘ç»œé”™è¯¯ï¼‰
  DEBUG  â€” å¼€å‘è°ƒè¯•ï¼ˆå®Œæ•´ API äº¤äº’ï¼‰
```

### 8.5 å‘å¸ƒä¸åˆ†å‘

```
Release äº§ç‰©ï¼ˆé€šè¿‡ GoReleaserï¼‰ï¼š

  cicost_0.1.0_linux_amd64.tar.gz
  cicost_0.1.0_linux_arm64.tar.gz
  cicost_0.1.0_darwin_amd64.tar.gz
  cicost_0.1.0_darwin_arm64.tar.gz
  cicost_0.1.0_windows_amd64.zip
  checksums.txt

åˆ†å‘æ¸ é“ï¼š
  1. GitHub Releasesï¼ˆä¸»è¦ï¼‰
  2. gh extensionï¼ˆgh extension install user/gh-cicostï¼‰
  3. Homebrew tapï¼ˆbrew install user/tap/cicostï¼‰
  4. Go installï¼ˆgo install github.com/user/cicost@latestï¼‰
```

---

## 9. éªŒæ”¶æ ‡å‡†ï¼ˆç»†åŒ–åˆ°å¯æµ‹è¯•ï¼‰

### 9.1 åŠŸèƒ½éªŒæ”¶

#### AC-SCAN-01: åŸºæœ¬æ•°æ®æ‹‰å–

```
å‰æï¼šç”¨æˆ·å·²è®¤è¯ï¼Œä»“åº“ owner/repo å­˜åœ¨ä¸”æœ‰ Actions å†å²

æ“ä½œï¼šcicost scan --repo owner/repo --days 30

éªŒè¯ï¼š
  [x] æˆåŠŸè¿”å› exit code 0
  [x] è¾“å‡ºæ‘˜è¦åŒ…å«ï¼šruns æ•°é‡ã€jobs æ•°é‡ã€API è°ƒç”¨æ•°ã€è€—æ—¶
  [x] SQLite æ–‡ä»¶åˆ›å»ºåœ¨ ~/.cicost/data/ ä¸‹
  [x] workflow_runs è¡¨æœ‰æ•°æ®ï¼Œæ•°é‡ > 0
  [x] jobs è¡¨æœ‰æ•°æ®ï¼Œæ•°é‡ > 0
  [x] sync_cursors è¡¨æœ‰è¯¥ repo çš„è®°å½•
  [x] æ‰€æœ‰ run çš„ created_at åœ¨ [now-30d, now] èŒƒå›´å†…
  [x] æ¯ä¸ª run è‡³å°‘æœ‰ 1 ä¸ª jobï¼ˆé™¤é run è¢«è·³è¿‡ï¼‰
```

#### AC-SCAN-02: å¢é‡åŒæ­¥

```
å‰æï¼šå·²æ‰§è¡Œè¿‡ä¸€æ¬¡ scan

æ“ä½œï¼š
  1. cicost scan --repo owner/repo --days 30ï¼ˆé¦–æ¬¡ï¼‰
  2. ç­‰å¾… 10 ç§’
  3. cicost scan --repo owner/repo --days 30ï¼ˆç¬¬äºŒæ¬¡ï¼‰

éªŒè¯ï¼š
  [x] ç¬¬äºŒæ¬¡ scan çš„ "new" æ•°é‡ <= ç¬¬ä¸€æ¬¡
  [x] ç¬¬äºŒæ¬¡ scan çš„ API è°ƒç”¨æ•° < ç¬¬ä¸€æ¬¡çš„ 50%
  [x] ç¬¬äºŒæ¬¡ scan çš„è€—æ—¶ < ç¬¬ä¸€æ¬¡çš„ 50%
  [x] sync_cursors.last_sync_at å·²æ›´æ–°
  [x] æ•°æ®æ€»é‡ä¸€è‡´ï¼ˆä¸é‡å¤ã€ä¸é—æ¼ï¼‰
```

#### AC-SCAN-03: åˆ†é¡µå¤„ç†

```
å‰æï¼šä»“åº“æœ‰ > 100 ä¸ª workflow runsï¼ˆè¶…è¿‡å•é¡µï¼‰

æ“ä½œï¼šcicost scan --repo owner/repo --days 90

éªŒè¯ï¼š
  [x] æ‰€æœ‰ runs è¢«æ‹‰å–ï¼ˆä¸æ­¢å‰ 100 æ¡ï¼‰
  [x] å¯¹æ¯” GitHub UI ä¸Šçš„ run æ•°é‡ï¼Œå·®å¼‚ < 5%
  [x] æ— é‡å¤ run_id è®°å½•
```

#### AC-SCAN-04: é”™è¯¯ä¸é‡è¯•

```
åœºæ™¯ Aï¼šæ— æ•ˆ Token
  æ“ä½œï¼šGITHUB_TOKEN=invalid cicost scan --repo owner/repo
  éªŒè¯ï¼š
    [x] exit code = 1
    [x] è¾“å‡ºåŒ…å« "authentication" æˆ– "token"
    [x] è¾“å‡ºåŒ…å«ä¿®å¤å»ºè®®ï¼ˆHintï¼‰

åœºæ™¯ Bï¼šä¸å­˜åœ¨çš„ä»“åº“
  æ“ä½œï¼šcicost scan --repo owner/nonexistent
  éªŒè¯ï¼š
    [x] exit code = 1
    [x] è¾“å‡ºåŒ…å« "not found" æˆ– "no access"

åœºæ™¯ Cï¼šé€Ÿç‡é™åˆ¶
  æ¨¡æ‹Ÿï¼šmock API è¿”å› 403 + X-RateLimit-Remaining: 0
  éªŒè¯ï¼š
    [x] è‡ªåŠ¨ç­‰å¾…å¹¶é‡è¯•
    [x] è¾“å‡ºåŒ…å«ç­‰å¾…æ—¶é—´æç¤º
    [x] æœ€å¤šé‡è¯• 3 æ¬¡åæ”¾å¼ƒ
    [x] å·²è·å–çš„æ•°æ®ä¸ä¸¢å¤±ï¼ˆpartial saveï¼‰
```

#### AC-SCAN-05: å¹¶å‘æ‹‰å–

```
æ“ä½œï¼šcicost scan --repo owner/repo --days 30 --workers 4

éªŒè¯ï¼š
  [x] åŒæ—¶æœ€å¤š 4 ä¸ªå¹¶å‘ API è¯·æ±‚
  [x] æ—  data raceï¼ˆgo test -race é€šè¿‡ï¼‰
  [x] è¿›åº¦æ¡æ­£ç¡®æ˜¾ç¤ºï¼ˆä¸ä¹±åºï¼‰
  [x] é€Ÿç‡é™åˆ¶åœ¨æ‰€æœ‰ worker é—´å…±äº«
```

#### AC-REPORT-01: æŠ¥å‘Šç”Ÿæˆï¼ˆtable æ ¼å¼ï¼‰

```
å‰æï¼šå·²æ‰§è¡Œ scanï¼Œæœ¬åœ°æœ‰æ•°æ®

æ“ä½œï¼šcicost report --repo owner/repo --days 30 --format table

éªŒè¯ï¼š
  [x] è¾“å‡ºåŒ…å«ä»¥ä¸‹åŒºå—ï¼š
      - SUMMARYï¼štotal runs, total minutes, estimated cost
      - WASTEï¼šfail rate, rerun waste, cancel waste, total waste
      - BY OSï¼šlinux/windows/macos åˆ†åˆ—çš„ minutes å’Œ cost
  [x] æ‰€æœ‰é‡‘é¢æ˜¾ç¤º 2 ä½å°æ•°
  [x] ç™¾åˆ†æ¯”æ˜¾ç¤º 1 ä½å°æ•°
  [x] åŒ…å« pricing ç‰ˆæœ¬ä¿¡æ¯
  [x] åŒ…å« disclaimerï¼ˆä¼°ç®—å£°æ˜ï¼‰
  [x] åŒ…å« data completenessï¼ˆæ•°æ®å®Œæ•´åº¦ï¼‰
  [x] exit code = 0
```

#### AC-REPORT-02: æŠ¥å‘Šç”Ÿæˆï¼ˆMarkdown æ ¼å¼ï¼‰

```
æ“ä½œï¼šcicost report --repo owner/repo --format md --output report.md

éªŒè¯ï¼š
  [x] æ–‡ä»¶ report.md è¢«åˆ›å»º
  [x] å†…å®¹æ˜¯åˆæ³• Markdownï¼ˆå¯è¢« GitHub æ­£ç¡®æ¸²æŸ“ï¼‰
  [x] åŒ…å«æ ‡é¢˜ã€è¡¨æ ¼ã€è„šæ³¨
  [x] ç²˜è´´åˆ° GitHub Issue ä¸­å¯æ­£ç¡®æ˜¾ç¤º
```

#### AC-REPORT-03: æŠ¥å‘Šç”Ÿæˆï¼ˆJSON æ ¼å¼ï¼‰

```
æ“ä½œï¼šcicost report --repo owner/repo --format json

éªŒè¯ï¼š
  [x] è¾“å‡ºæ˜¯åˆæ³• JSONï¼ˆå¯è¢« jq è§£æï¼‰
  [x] åŒ…å« schema_version å­—æ®µ
  [x] åŒ…å« tool_version å­—æ®µ
  [x] åŒ…å« generated_atï¼ˆISO8601 UTCï¼‰
  [x] æ‰€æœ‰æ•°å€¼å­—æ®µç±»å‹æ­£ç¡®ï¼ˆnumber, not stringï¼‰
  [x] å¯ä¸ä¸Šä¸€ç‰ˆæœ¬ JSON åšç»“æ„å¯¹æ¯”ï¼ˆå‘åå…¼å®¹ï¼‰
```

#### AC-REPORT-04: è¶‹åŠ¿å¯¹æ¯”

```
å‰æï¼šæœ‰è‡³å°‘ 60 å¤©æ•°æ®

æ“ä½œï¼šcicost report --repo owner/repo --days 30 --compare

éªŒè¯ï¼š
  [x] æ˜¾ç¤ºå½“å‰å‘¨æœŸä¸ä¸Šä¸€å‘¨æœŸçš„å¯¹æ¯”
  [x] åŒ…å«å˜åŒ–æ–¹å‘ï¼šâ†‘ï¼ˆä¸Šå‡ï¼‰â†“ï¼ˆä¸‹é™ï¼‰â†’ï¼ˆæŒå¹³ï¼‰
  [x] åŒ…å«å˜åŒ–å¹…åº¦ï¼ˆç»å¯¹å€¼ + ç™¾åˆ†æ¯”ï¼‰
  [x] ä¸Šä¸€å‘¨æœŸæ— æ•°æ®æ—¶æ˜¾ç¤º "N/A (no prior data)"
```

#### AC-HOTSPOT-01: workflow ç»´åº¦æ’è¡Œ

```
æ“ä½œï¼šcicost hotspots --repo owner/repo --group-by workflow --top 5

éªŒè¯ï¼š
  [x] è¾“å‡º 5 è¡Œï¼ˆæˆ–å®é™… workflow æ•°ï¼Œå–è¾ƒå°å€¼ï¼‰
  [x] æŒ‰ cost é™åºæ’åˆ—
  [x] æ¯è¡ŒåŒ…å«ï¼šrank, workflow name, minutes, cost, cost%, fail_rate
  [x] cost% ä¹‹å’Œ â‰ˆ 100%ï¼ˆå‰ N çš„å æ¯”ï¼Œâ‰¤ 100%ï¼‰
  [x] å¦‚æœ workflow æ•° < top Nï¼Œæ˜¾ç¤ºå…¨éƒ¨å¹¶æç¤º
```

#### AC-HOTSPOT-02: job ç»´åº¦æ’è¡Œ

```
æ“ä½œï¼šcicost hotspots --repo owner/repo --group-by job --top 10

éªŒè¯ï¼š
  [x] æŒ‰ job name èšåˆï¼ˆè·¨ workflow åŒå job åˆ†å¼€ï¼‰
  [x] æ ¼å¼ï¼šworkflow_name / job_name
  [x] åŒ…å« runner_os ä¿¡æ¯
```

#### AC-HOTSPOT-03: runner ç»´åº¦æ’è¡Œ

```
æ“ä½œï¼šcicost hotspots --repo owner/repo --group-by runner

éªŒè¯ï¼š
  [x] æŒ‰ runner_os èšåˆï¼šLinux / Windows / macOS / self-hosted
  [x] self-hosted æ ‡æ³¨ cost = $0.00
  [x] è¾“å‡º"åˆ†é’Ÿå æ¯” vs æˆæœ¬å æ¯”"å¯¹æ¯”ï¼ˆä½“ç°ä¹˜æ•°æ•ˆåº”ï¼‰
```

#### AC-HOTSPOT-04: branch ç»´åº¦æ’è¡Œ

```
æ“ä½œï¼šcicost hotspots --repo owner/repo --group-by branch --top 10

éªŒè¯ï¼š
  [x] æŒ‰ head_branch èšåˆ
  [x] ä¸»åˆ†æ”¯ï¼ˆmain/masterï¼‰å•ç‹¬æ ‡æ³¨
  [x] å¯ä»¥å‘ç°"æŸä¸ª feature branch CI è·‘å¤ªå¤š"
```

#### AC-BUDGET-01: é¢„ç®—æœªè¶…é™

```
å‰æï¼šæœ¬æœˆæˆæœ¬ $30

æ“ä½œï¼šcicost budget --repo owner/repo --monthly 100

éªŒè¯ï¼š
  [x] exit code = 0
  [x] è¾“å‡ºçŠ¶æ€ "âœ… OK" æˆ– "WITHIN BUDGET"
  [x] æ˜¾ç¤º actual / budget / projected
  [x] budget_checks è¡¨å†™å…¥ä¸€æ¡è®°å½•ï¼Œexceeded = 0
```

#### AC-BUDGET-02: é¢„ç®—å·²è¶…é™

```
å‰æï¼šæœ¬æœˆæˆæœ¬ $120

æ“ä½œï¼šcicost budget --repo owner/repo --monthly 100

éªŒè¯ï¼š
  [x] exit code = 2
  [x] è¾“å‡ºçŠ¶æ€ "ğŸ”´ EXCEEDED"
  [x] æ˜¾ç¤º actual ($120) / budget ($100) / è¶…å‡ºæ¯”ä¾‹ (120%)
  [x] æ˜¾ç¤º top 3 contributors
  [x] æ˜¾ç¤ºè‡³å°‘ä¸€æ¡å¯æ‰§è¡Œå»ºè®®
  [x] budget_checks è¡¨å†™å…¥ä¸€æ¡è®°å½•ï¼Œexceeded = 1
```

#### AC-BUDGET-03: é¢„ç®—é¢„æµ‹å°†è¶…

```
å‰æï¼šæœ¬æœˆè¿‡åŠï¼Œå½“å‰æˆæœ¬ $60ï¼Œæœˆé¢„ç®— $100

æ“ä½œï¼šcicost budget --repo owner/repo --monthly 100

éªŒè¯ï¼š
  [x] exit code = 2
  [x] è¾“å‡ºçŠ¶æ€ "ğŸŸ¡ WARNING" æˆ– "PROJECTED TO EXCEED"
  [x] æ˜¾ç¤º projectedï¼ˆçº¿æ€§å¤–æ¨ï¼‰
  [x] æ˜¾ç¤º top contributors
```

#### AC-BUDGET-04: Webhook é€šçŸ¥

```
æ“ä½œï¼šcicost budget --monthly 50 --notify webhook --webhook-url https://example.com/hook

éªŒè¯ï¼š
  [x] å‘æŒ‡å®š URL å‘é€ POST è¯·æ±‚
  [x] Content-Type: application/json
  [x] Body åŒ…å« status, repo, budget, actual, projected, top_contributors
  [x] HTTP é 2xx æ—¶è¾“å‡ºè­¦å‘Šä½†ä¸å½±å“ exit code åˆ¤æ–­
```

#### AC-EXPLAIN-01: å»ºè®®ç”Ÿæˆ

```
æ“ä½œï¼šcicost explain --repo owner/repo

éªŒè¯ï¼š
  [x] è‡³å°‘è¾“å‡º 1 æ¡å»ºè®®ï¼ˆå¦‚æœæ•°æ®ä¸­å­˜åœ¨å¯ä¼˜åŒ–é¡¹ï¼‰
  [x] å»ºè®®æŒ‰å½±å“åŠ›åˆ†çº§ï¼šHIGH / MEDIUM / LOW
  [x] æ¯æ¡å»ºè®®åŒ…å«ï¼šé—®é¢˜æè¿°ã€å½“å‰æ•°æ®ã€é¢„ä¼°èŠ‚çœ
  [x] ä¸è¾“å‡ºæ— æ•°æ®æ”¯æ’‘çš„å»ºè®®ï¼ˆä¸ççŒœï¼‰
  [x] æ— å¯ä¼˜åŒ–é¡¹æ—¶è¾“å‡º"No significant optimization opportunities found"
```

#### AC-INIT-01: äº¤äº’å¼åˆå§‹åŒ–

```
æ“ä½œï¼šcicost init

éªŒè¯ï¼š
  [x] æ£€æµ‹è®¤è¯çŠ¶æ€å¹¶æç¤º
  [x] å¼•å¯¼è®¾ç½®é»˜è®¤ä»“åº“
  [x] å¼•å¯¼é€‰æ‹©å®šä»·æ–¹æ¡ˆ
  [x] ç”Ÿæˆ ~/.cicost/config.yml
  [x] æ–‡ä»¶æ ¼å¼æ­£ç¡®å¯è¢«åç»­å‘½ä»¤è¯»å–
  [x] äºŒæ¬¡è¿è¡Œæç¤º"é…ç½®å·²å­˜åœ¨ï¼Œæ˜¯å¦è¦†ç›–ï¼Ÿ"
```

### 9.2 æ•°æ®ä¸è®¡ç®—éªŒæ”¶

#### AC-CALC-01: æˆæœ¬è®¡ç®—å‡†ç¡®æ€§

```
è¾“å…¥ fixtureï¼š
  10 ä¸ª Linux jobï¼Œæ¯ä¸ª 65 ç§’
  5 ä¸ª macOS jobï¼Œæ¯ä¸ª 125 ç§’
  3 ä¸ª Windows jobï¼Œæ¯ä¸ª 200 ç§’
  pricing: linux=$0.008/min, win=Ã—2, mac=Ã—10
  free_tier: 0ï¼ˆä¸ºç®€åŒ–éªŒè¯ï¼‰

é¢„æœŸè®¡ç®—ï¼š
  Linux:  10 Ã— ceil(65/60) = 10 Ã— 2 = 20 min Ã— 1  = 20 billable min
  macOS:   5 Ã— ceil(125/60) = 5 Ã— 3 = 15 min Ã— 10 = 150 billable min
  Windows: 3 Ã— ceil(200/60) = 3 Ã— 4 = 12 min Ã— 2  = 24 billable min
  Total billable = 194 min
  Cost = 194 Ã— $0.008 = $1.552 â†’ $1.55

éªŒè¯ï¼š
  [x] CostResult.TotalCostUSD == 1.55ï¼ˆÂ±0.01ï¼‰
  [x] CostResult.ByOS["Linux"].Minutes == 20
  [x] CostResult.ByOS["macOS"].Minutes == 15
  [x] CostResult.ByOS["macOS"].BillableMinutes == 150
  [x] æ¯ä¸ª job ç‹¬ç«‹ ceilï¼ˆä¸æ˜¯å…ˆæ±‚å’Œå† ceilï¼‰
```

#### AC-CALC-02: å…è´¹é¢åº¦æ‰£å‡

```
è¾“å…¥ fixtureï¼š
  Total billable minutes = 2500
  free_tier = 2000
  pricing: $0.008/min

é¢„æœŸï¼š
  charged = 2500 - 2000 = 500 min
  cost = 500 Ã— $0.008 = $4.00

éªŒè¯ï¼š
  [x] FreeTierUsed == 2000
  [x] TotalCostUSD == 4.00
  [x] Disclaimer åŒ…å« "free tier" ç›¸å…³è¯´æ˜
```

#### AC-CALC-03: å»é‡æ­£ç¡®æ€§

```
è¾“å…¥ fixtureï¼š
  run_id=100, attempt=1, jobs: [A=5min, B=3min]
  run_id=100, attempt=2, jobs: [A=5min, B=3min]ï¼ˆé‡è·‘ï¼‰

éªŒè¯ï¼š
  [x] æ€»æˆæœ¬ = attempt 1 çš„ cost + attempt 2 çš„ costï¼ˆéƒ½ç»Ÿè®¡ï¼‰
  [x] rerun_waste = attempt 1 çš„ costï¼ˆæµªè´¹çš„éƒ¨åˆ†ï¼‰
  [x] ä¸å­˜åœ¨ (run_id=100, attempt=1) çš„é‡å¤è®°å½•
```

#### AC-CALC-04: Self-hosted æ’é™¤

```
è¾“å…¥ fixtureï¼š
  Job A: runner_os=Linux, is_self_hosted=false, 10 min
  Job B: runner_os=Linux, is_self_hosted=true, 20 min

éªŒè¯ï¼š
  [x] åªæœ‰ Job A è®¡å…¥æˆæœ¬
  [x] Job B çš„ cost = $0.00
  [x] æŠ¥å‘Šä¸­æ ‡æ³¨ "self-hosted runners excluded from cost"
```

#### AC-CALC-05: æ—¶é—´çª—å£è¿‡æ»¤

```
è¾“å…¥ï¼š--days 30ï¼Œå½“å‰æ—¶é—´ 2026-02-26T12:00:00Z

éªŒè¯ï¼š
  [x] åªåŒ…å« run_started_at >= 2026-01-27T00:00:00Z çš„ runs
  [x] ä¸åŒ…å« 2026-01-26 çš„ runs
  [x] æŠ¥å‘Šä¸­æ˜¾ç¤º "Period: 2026-01-27 ~ 2026-02-26 (UTC)"
```

### 9.3 å·¥ç¨‹è´¨é‡éªŒæ”¶

#### AC-QUAL-01: è·¨å¹³å°å¯ç”¨

```
éªŒè¯ï¼š
  [x] Linux amd64ï¼šäºŒè¿›åˆ¶å¯æ‰§è¡Œï¼Œscan + report é€šè¿‡
  [x] macOS arm64ï¼šäºŒè¿›åˆ¶å¯æ‰§è¡Œï¼Œscan + report é€šè¿‡
  [x] Windows amd64ï¼šäºŒè¿›åˆ¶å¯æ‰§è¡Œï¼Œscan + report é€šè¿‡
  [x] æ¯ä¸ªå¹³å°çš„å®‰è£…æ—¶é—´ < 1 åˆ†é’Ÿ
```

#### AC-QUAL-02: æ— äº¤äº’æ¨¡å¼

```
æ“ä½œï¼šcicost report --repo owner/repo --format json --no-color --quiet

éªŒè¯ï¼š
  [x] æ— è¿›åº¦æ¡ã€æ— é¢œè‰²ã€æ— äº¤äº’æç¤º
  [x] stdout åªæœ‰çº¯ JSON è¾“å‡º
  [x] å¯åœ¨ CI/CD pipeline ä¸­ä½¿ç”¨
  [x] å¯è¢«ç®¡é“ç¬¦ä¼ é€’ï¼šcicost report --format json | jq '.cost.total'
```

#### AC-QUAL-03: å¸®åŠ©æ–‡æ¡£

```
éªŒè¯ï¼š
  [x] cicost --help         æ˜¾ç¤ºæ‰€æœ‰å­å‘½ä»¤ä¸ç®€ä»‹
  [x] cicost scan --help    æ˜¾ç¤ºæ‰€æœ‰å‚æ•°ã€é»˜è®¤å€¼ã€ç¤ºä¾‹
  [x] cicost report --help  åŒä¸Š
  [x] æ¯ä¸ªå­å‘½ä»¤å¸®åŠ©åŒ…å«è‡³å°‘ 1 ä¸ªä½¿ç”¨ç¤ºä¾‹
  [x] å¸®åŠ©æ–‡æœ¬æ— æ‹¼å†™é”™è¯¯
```

#### AC-QUAL-04: ç‰ˆæœ¬ä¿¡æ¯

```
æ“ä½œï¼šcicost version

éªŒè¯ï¼š
  [x] è¾“å‡ºæ ¼å¼ï¼šcicost v0.1.0 (commit: abc1234, built: 2026-02-26)
  [x] åŒ…å« version, git commit hash, build date
```

#### AC-QUAL-05: æ€§èƒ½åŸºå‡†

```
éªŒè¯ï¼ˆbenchmark repo: ~500 runs, ~2000 jobsï¼‰ï¼š
  [x] é¦–æ¬¡ scan å®Œæˆ < 60 ç§’ï¼ˆå« API è°ƒç”¨ï¼‰
  [x] å¢é‡ scan å®Œæˆ < 10 ç§’
  [x] report ç”Ÿæˆ < 2 ç§’ï¼ˆçº¯æœ¬åœ°è®¡ç®—ï¼‰
  [x] SQLite æ–‡ä»¶å¤§å° < 50 MB
  [x] å†…å­˜ä½¿ç”¨ < 200 MB
```

#### AC-QUAL-06: æ•°æ®å®‰å…¨

```
éªŒè¯ï¼š
  [x] Token ä¸å†™å…¥ SQLite æˆ–æ—¥å¿—æ–‡ä»¶
  [x] --debug æ¨¡å¼ä¸‹ Authorization header è¢« mask
  [x] SQLite æ–‡ä»¶æƒé™ï¼šä»…å½“å‰ç”¨æˆ·å¯è¯»å†™ï¼ˆ0600ï¼‰
  [x] config.yml ä¸­çš„ token å­—æ®µæ”¯æŒç¯å¢ƒå˜é‡å¼•ç”¨ ${GITHUB_TOKEN}
```

### 9.4 æµ‹è¯•éªŒæ”¶

#### AC-TEST-01: å•å…ƒæµ‹è¯•è¦†ç›–

```
æœ€ä½è¦†ç›–è¦æ±‚ï¼šæ ¸å¿ƒæ¨¡å— > 80%

å¿…é¡»è¦†ç›–çš„å•å…ƒæµ‹è¯•ï¼š
  [x] pricing/engine.go
      - Linux job æˆæœ¬è®¡ç®—
      - Windows job æˆæœ¬è®¡ç®—ï¼ˆå«ä¹˜æ•°ï¼‰
      - macOS job æˆæœ¬è®¡ç®—ï¼ˆå«ä¹˜æ•°ï¼‰
      - ceil å–æ•´é€»è¾‘ï¼ˆ59s=1min, 60s=1min, 61s=2minï¼‰
      - å…è´¹é¢åº¦æ‰£å‡ï¼ˆ0/éƒ¨åˆ†/å…¨éƒ¨è¦†ç›–ï¼‰
      - self-hosted æ’é™¤
  [x] analytics/waste.go
      - å¤±è´¥ç‡è®¡ç®—
      - rerun æµªè´¹è®¡ç®—
      - cancel æµªè´¹è®¡ç®—
      - æ— æµªè´¹åœºæ™¯ï¼ˆå…¨éƒ¨æˆåŠŸï¼‰
  [x] analytics/hotspots.go
      - workflow åˆ†ç»„èšåˆ
      - job åˆ†ç»„èšåˆ
      - runner åˆ†ç»„èšåˆ
      - æ’åºæ­£ç¡®æ€§
      - top N æˆªå–
  [x] analytics/budget.go
      - æœªè¶…é¢„ç®—
      - å·²è¶…é¢„ç®—
      - é¢„æµ‹è¶…é¢„ç®—
      - çº¿æ€§å¤–æ¨ç®—æ³•
  [x] github/pagination.go
      - å•é¡µå“åº”
      - å¤šé¡µå“åº”
      - ç©ºå“åº”
  [x] store/sync.go
      - é¦–æ¬¡åŒæ­¥ï¼ˆæ—  cursorï¼‰
      - å¢é‡åŒæ­¥ï¼ˆæœ‰ cursorï¼‰
      - cursor æ›´æ–°
  [x] output/json.go
      - schema_version å­˜åœ¨
      - å­—æ®µç±»å‹æ­£ç¡®
```

#### AC-TEST-02: é›†æˆæµ‹è¯•

```
ä½¿ç”¨ fixture æ–‡ä»¶ï¼ˆtestdata/ ä¸‹çš„å½•åˆ¶ JSONï¼‰ï¼š

  [x] å®Œæ•´æµç¨‹æµ‹è¯•ï¼š
      fixture API å“åº” â†’ scanï¼ˆå†™å…¥ SQLiteï¼‰â†’ report â†’ éªŒè¯è¾“å‡º
  [x] ä¸ä¾èµ–çœŸå® GitHub APIï¼ˆCI ä¸­ç¨³å®šå¯è¿è¡Œï¼‰
  [x] è¦†ç›–è‡³å°‘ 3 ç§åœºæ™¯ï¼š
      - æ­£å¸¸ repoï¼ˆæœ‰æˆåŠŸ/å¤±è´¥/å–æ¶ˆçš„ runsï¼‰
      - ç©º repoï¼ˆæ—  runsï¼‰
      - å¤§ repoï¼ˆå¤šé¡µæ•°æ®ï¼‰
  [x] mock HTTP server ç”¨äºæ¨¡æ‹Ÿ API å“åº”
```

#### AC-TEST-03: CI Pipeline

```
GitHub Actions workflow åŒ…å«ï¼š
  [x] go test -race ./...               # æ‰€æœ‰æµ‹è¯• + data race æ£€æµ‹
  [x] go vet ./...                       # é™æ€åˆ†æ
  [x] golangci-lint run                  # lint
  [x] go build for linux/mac/windows     # äº¤å‰ç¼–è¯‘
  [x] æµ‹è¯•é€šè¿‡ç‡ 100%                     # ä¸å…è®¸è·³è¿‡
```

---

## 10. é‡Œç¨‹ç¢‘ä¸æ’æœŸ

```
Week 1: MVP å¯ç”¨
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

D1 (Day 1): éª¨æ¶ + è®¤è¯ + æœ€å° fetch
  â”œâ”€ é¡¹ç›®åˆå§‹åŒ–ï¼ˆgo mod, cmd ç»“æ„, Makefileï¼‰
  â”œâ”€ auth æ¨¡å—ï¼ˆgh token / env varï¼‰
  â”œâ”€ GitHub clientï¼ˆåŸºç¡€ HTTP + rate limit header è§£æï¼‰
  â”œâ”€ scan å‘½ä»¤ï¼ˆå•é¡µ workflow runs æ‹‰å–ï¼‰
  â””â”€ éªŒæ”¶ï¼šèƒ½æ‹‰åˆ°ä¸€ä¸ª repo çš„ç¬¬ä¸€é¡µ runs å¹¶æ‰“å°

D2: åˆ†é¡µ + ç¼“å­˜ + report
  â”œâ”€ pagination æ¨¡å—ï¼ˆLink header è§£æ / per_page=100ï¼‰
  â”œâ”€ SQLite storeï¼ˆå»ºè¡¨ + å†™å…¥ + æŸ¥è¯¢ï¼‰
  â”œâ”€ jobs æ‹‰å–ï¼ˆæ¯ä¸ª run æ‹‰ jobsï¼‰
  â”œâ”€ report å‘½ä»¤ï¼ˆtable æ ¼å¼åŸºç¡€ç‰ˆï¼‰
  â””â”€ éªŒæ”¶ï¼š30 å¤©æ•°æ®å…¥åº“ + è¾“å‡ºåŸºæœ¬è¡¨æ ¼

D3: hotspots + pricing + æˆæœ¬è®¡ç®—
  â”œâ”€ pricing å¼•æ“ï¼ˆåŠ è½½ yml + è®¡ç®—é€»è¾‘ï¼‰
  â”œâ”€ æˆæœ¬è®¡ç®—æ¨¡å—ï¼ˆby OS + ceil + free tierï¼‰
  â”œâ”€ hotspots å‘½ä»¤ï¼ˆworkflow/job/runner èšåˆï¼‰
  â”œâ”€ å•å…ƒæµ‹è¯•ï¼špricing + cost
  â””â”€ éªŒæ”¶ï¼šhotspots è¾“å‡ºæ­£ç¡®æ’è¡Œ + æˆæœ¬æ•°å€¼åˆç†

D4: waste + budget + explain
  â”œâ”€ waste è®¡ç®—æ¨¡å—ï¼ˆfail rate + rerun + cancelï¼‰
  â”œâ”€ budget å‘½ä»¤ï¼ˆé˜ˆå€¼åˆ¤æ–­ + exit codeï¼‰
  â”œâ”€ explain å‘½ä»¤ï¼ˆè§„åˆ™å¼•æ“ v1ï¼š3-5 æ¡è§„åˆ™ï¼‰
  â”œâ”€ å¢é‡åŒæ­¥ï¼ˆsync cursorï¼‰
  â””â”€ éªŒæ”¶ï¼šbudget è¶…é™è¿”å› exit 2 + explain è¾“å‡ºå»ºè®®

D5: è¾“å‡ºæ ¼å¼ + æµ‹è¯• + æ‰“åŒ…
  â”œâ”€ Markdown è¾“å‡º
  â”œâ”€ JSON è¾“å‡ºï¼ˆå« schema_versionï¼‰
  â”œâ”€ CSV è¾“å‡º
  â”œâ”€ fixture é›†æˆæµ‹è¯•
  â”œâ”€ GoReleaser é…ç½® + GitHub Release
  â””â”€ éªŒæ”¶ï¼šä¸‰ç§æ ¼å¼è¾“å‡ºæ­£ç¡® + äºŒè¿›åˆ¶å¯ä¸‹è½½è¿è¡Œ

Week 2: ç”¨æˆ·è·å– + è¿­ä»£
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

D6: åˆ†å‘ + init
  â”œâ”€ gh extension é€‚é… + å‘å¸ƒ
  â”œâ”€ Homebrew formula
  â”œâ”€ cicost init å‘½ä»¤
  â”œâ”€ README å®Œå–„ï¼ˆå®‰è£…ã€ä½¿ç”¨ã€ç¤ºä¾‹ï¼‰
  â””â”€ éªŒæ”¶ï¼šä¸‰ç§å®‰è£…æ–¹å¼å¯ç”¨

D7: Demo æŠ¥å‘Šåˆ¶ä½œ
  â”œâ”€ é€‰ 5 ä¸ªå…¬å¼€çŸ¥å repo è¿è¡Œ cicost
  â”œâ”€ ç”Ÿæˆ Markdown æŠ¥å‘Š
  â”œâ”€ å†™ä¸€ç¯‡ "CI Cost Insights" åšå®¢/å¸–å­
  â””â”€ éªŒæ”¶ï¼š5 ä»½å¯å±•ç¤ºçš„ demo æŠ¥å‘Š

D8-D10: ç”¨æˆ·è§¦è¾¾
  â”œâ”€ è”ç³» 30 ä¸ªç›®æ ‡ repo/å›¢é˜Ÿ
  â”œâ”€ åœ¨ç›¸å…³ GitHub Discussions / Issues æä¾›å…è´¹ä½“æ£€
  â”œâ”€ å‘å¸ƒåˆ° Hacker News / Reddit / Indie Hackers
  â””â”€ éªŒæ”¶ï¼š10 ä¸ªçœŸå®ç”¨æˆ·å®‰è£…è¿è¡Œ

D11-D14: åé¦ˆè¿­ä»£
  â”œâ”€ æ”¶é›†ç”¨æˆ·åé¦ˆ
  â”œâ”€ ä¿®å¤ bug + è¡¥å……ç¼ºå¤±åŠŸèƒ½
  â”œâ”€ 2-3 è½®å¿«é€Ÿè¿­ä»£
  â””â”€ éªŒæ”¶ï¼š3 ä¸ªç”¨æˆ·è¡¨ç¤º"æ¯å‘¨ä¼šç”¨"
```

---

## 11. é£é™©æ¸…å•ä¸é™çº§

```
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID â”‚ é£é™©                     â”‚ æ¦‚ç‡/å½±å“â”‚ é™çº§æ–¹æ¡ˆ                          â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ R1 â”‚ GitHub API é€Ÿç‡é™åˆ¶       â”‚ é«˜/ä¸­    â”‚ ç¼“å­˜ + å¢é‡åŒæ­¥ + é™ä½ workers   â”‚
â”‚    â”‚ å¯¼è‡´å¤§ä»“åº“ scan å¾ˆæ…¢      â”‚          â”‚ + è¿›åº¦æ¡æç¤ºé¢„ä¼°æ—¶é—´             â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ R2 â”‚ æˆæœ¬ä¼°ç®—ä¸å®˜æ–¹è´¦å•ä¸ä¸€è‡´   â”‚ ä¸­/é«˜    â”‚ æ˜ç¡®æ ‡æ³¨ "estimate" + disclaimer â”‚
â”‚    â”‚ ç”¨æˆ·è´¨ç–‘æ•°æ®å¯ä¿¡åº¦         â”‚          â”‚ + æ”¯æŒç”¨æˆ·è¾“å…¥å®é™…è´¦å•æ ¡å‡†       â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ R3 â”‚ GitHub è°ƒæ•´ Actions å®šä»·  â”‚ ä½/ä¸­    â”‚ pricing.yml å¯é…ç½® + ç‰ˆæœ¬æ ‡æ³¨    â”‚
â”‚    â”‚ æˆ– API å­—æ®µå˜åŒ–           â”‚          â”‚ + æä¾›å®˜æ–¹ä»·æ ¼é¡µé“¾æ¥             â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ R4 â”‚ ç§æœ‰ä»“åº“æƒé™ä¸è¶³          â”‚ ä¸­/ä¸­    â”‚ æ£€æµ‹ scope å¹¶æç¤ºæ‰€éœ€æƒé™        â”‚
â”‚    â”‚ Token scope ä¸å¤Ÿ          â”‚          â”‚ + ç»™å‡º gh auth refresh å‘½ä»¤     â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ R5 â”‚ å…è´¹é¢åº¦è·¨ä»“åº“å…±äº«        â”‚ é«˜/ä¸­    â”‚ æ ‡æ³¨"å•ä»“åº“ä¼°ç®—,å®é™…å…è´¹é¢åº¦     â”‚
â”‚    â”‚ å•ä»“åº“æ— æ³•å‡†ç¡®è®¡ç®—         â”‚          â”‚ å¯èƒ½å·²è¢«å…¶ä»–ä»“åº“æ¶ˆè€—"           â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ R6 â”‚ ç”¨æˆ·ä¸æ„¿åœ¨ç»ˆç«¯çœ‹æŠ¥å‘Š      â”‚ ä¸­/ä½    â”‚ --format md è¾“å‡ºå¯è´´åˆ°ä»»ä½•åœ°æ–¹   â”‚
â”‚    â”‚ åå¥½ Web UI               â”‚          â”‚ åç»­å¯åš Web dashboardï¼ˆV2ï¼‰     â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ R7 â”‚ Go å¼€å‘æ•ˆç‡ä¸åŠé¢„æœŸ       â”‚ ä½/ä¸­    â”‚ é™çº§åˆ° Node/TS + pkg æ‰“åŒ…       â”‚
â”‚    â”‚ 1 å‘¨å®Œä¸æˆ MVP            â”‚          â”‚ æˆ–å…ˆåšæ ¸å¿ƒ 3 å‘½ä»¤ï¼Œç  explain   â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 12. é™„å½•

### é™„å½• Aï¼šGitHub API ç«¯ç‚¹æ¸…å•

```
1. List workflow runs
   GET /repos/{owner}/{repo}/actions/runs
   å‚æ•°ï¼šcreated=>=2026-01-27, per_page=100, page=N
   ç”¨é€”ï¼šæ‹‰å– workflow run åˆ—è¡¨

2. List jobs for a workflow run
   GET /repos/{owner}/{repo}/actions/runs/{run_id}/jobs
   å‚æ•°ï¼šper_page=100
   ç”¨é€”ï¼šæ‹‰å–æ¯ä¸ª run ä¸‹çš„ job åˆ—è¡¨ï¼ˆå« runner_os, durationï¼‰

3. List workflow run attempts
   GET /repos/{owner}/{repo}/actions/runs/{run_id}/attempts/{attempt}
   ç”¨é€”ï¼šæ‹‰å–ç‰¹å®š attempt çš„è¯¦æƒ…ï¼ˆç”¨äº rerun åˆ†æï¼‰

4. Get rate limit
   GET /rate_limit
   ç”¨é€”ï¼šæ£€æŸ¥å½“å‰å‰©ä½™é…é¢
```

### é™„å½• Bï¼šFixture æ•°æ®è§„æ ¼

```
testdata/
â”œâ”€â”€ scenario_normal/
â”‚   â”œâ”€â”€ runs_page1.json          # 100 runsï¼ˆå„ç§ conclusionï¼‰
â”‚   â”œâ”€â”€ runs_page2.json          # 34 runsï¼ˆç¬¬äºŒé¡µï¼‰
â”‚   â”œâ”€â”€ jobs_run_001.json        # run 001 çš„ jobs
â”‚   â”œâ”€â”€ jobs_run_002.json        # ...
â”‚   â””â”€â”€ expected_report.json     # æœŸæœ›çš„ report è¾“å‡º
â”œâ”€â”€ scenario_empty/
â”‚   â”œâ”€â”€ runs.json                # ç©ºï¼š{"workflow_runs":[],"total_count":0}
â”‚   â””â”€â”€ expected_report.json
â””â”€â”€ scenario_rerun/
    â”œâ”€â”€ runs.json                # åŒ…å« attempt=1 å’Œ attempt=2 çš„ run
    â”œâ”€â”€ jobs_attempt1.json
    â”œâ”€â”€ jobs_attempt2.json
    â””â”€â”€ expected_waste.json      # æœŸæœ›çš„æµªè´¹æŒ‡æ ‡
```

### é™„å½• Cï¼šJSON è¾“å‡º Schemaï¼ˆv1.0ï¼‰

```json
{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "type": "object",
  "required": ["schema_version", "tool_version", "generated_at", "repo", "period", "cost", "waste"],
  "properties": {
    "schema_version": { "type": "string", "const": "1.0" },
    "tool_version":   { "type": "string" },
    "generated_at":   { "type": "string", "format": "date-time" },
    "repo":           { "type": "string" },
    "period": {
      "type": "object",
      "properties": {
        "start":    { "type": "string", "format": "date-time" },
        "end":      { "type": "string", "format": "date-time" },
        "days":     { "type": "integer" },
        "timezone": { "type": "string", "const": "UTC" }
      }
    },
    "cost": {
      "type": "object",
      "properties": {
        "total_minutes":    { "type": "number" },
        "billable_minutes": { "type": "number" },
        "total_cost_usd":   { "type": "number" },
        "free_tier_used":   { "type": "number" },
        "by_os":            { "type": "array" },
        "pricing_snapshot": { "type": "object" },
        "data_completeness":{ "type": "number" },
        "disclaimer":       { "type": "string" }
      }
    },
    "waste": {
      "type": "object",
      "properties": {
        "total_runs":       { "type": "integer" },
        "failed_runs":      { "type": "integer" },
        "fail_rate":        { "type": "number" },
        "rerun_count":      { "type": "integer" },
        "rerun_waste_usd":  { "type": "number" },
        "cancel_waste_usd": { "type": "number" },
        "total_waste_usd":  { "type": "number" },
        "waste_percentage": { "type": "number" }
      }
    },
    "hotspots": { "type": "array" }
  }
}
```

---
